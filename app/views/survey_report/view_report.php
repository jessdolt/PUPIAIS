<?php require APPROOT . '/views/inc/header_admin.php'; ?>
<main class="admin dataInput">
            <section class="pageSpecificHeader"></section>
            <section class="mainContent adminForm questionnaire reportView">
                <form action="">
                    <div class="form" id="answer-form">
                    <input type="hidden" value="<?php echo URLROOT;?>" id="url-web">
                    <input type="hidden" value="<?php echo $data['survey']->id?>" id="survey-id">
                        <h2>
                            Survey
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9.47149 19.0139C9.23783 19.0143 9.0114 18.9329 8.83149 18.7839C8.73023 18.6999 8.64653 18.5968 8.58517 18.4805C8.52382 18.3641 8.48603 18.2368 8.47395 18.1058C8.46187 17.9749 8.47576 17.8428 8.5148 17.7172C8.55385 17.5916 8.61728 17.4749 8.70149 17.3739L13.1815 12.0139L8.86149 6.64386C8.77842 6.54157 8.71639 6.42387 8.67896 6.29753C8.64153 6.17119 8.62943 6.0387 8.64337 5.90767C8.65731 5.77665 8.69701 5.64966 8.76018 5.53403C8.82335 5.41839 8.90876 5.31638 9.01149 5.23386C9.11495 5.14282 9.23612 5.07415 9.36738 5.03216C9.49864 4.99017 9.63717 4.97577 9.77426 4.98986C9.91135 5.00394 10.0441 5.04621 10.164 5.11401C10.284 5.18181 10.3887 5.27368 10.4715 5.38386L15.3015 11.3839C15.4486 11.5628 15.529 11.7872 15.529 12.0189C15.529 12.2505 15.4486 12.4749 15.3015 12.6539L10.3015 18.6539C10.2012 18.7749 10.0737 18.8705 9.92953 18.9331C9.78532 18.9956 9.62839 19.0233 9.47149 19.0139Z" fill="#A63F3F"/>
                            </svg>
                            Report
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9.47149 19.0139C9.23783 19.0143 9.0114 18.9329 8.83149 18.7839C8.73023 18.6999 8.64653 18.5968 8.58517 18.4805C8.52382 18.3641 8.48603 18.2368 8.47395 18.1058C8.46187 17.9749 8.47576 17.8428 8.5148 17.7172C8.55385 17.5916 8.61728 17.4749 8.70149 17.3739L13.1815 12.0139L8.86149 6.64386C8.77842 6.54157 8.71639 6.42387 8.67896 6.29753C8.64153 6.17119 8.62943 6.0387 8.64337 5.90767C8.65731 5.77665 8.69701 5.64966 8.76018 5.53403C8.82335 5.41839 8.90876 5.31638 9.01149 5.23386C9.11495 5.14282 9.23612 5.07415 9.36738 5.03216C9.49864 4.99017 9.63717 4.97577 9.77426 4.98986C9.91135 5.00394 10.0441 5.04621 10.164 5.11401C10.284 5.18181 10.3887 5.27368 10.4715 5.38386L15.3015 11.3839C15.4486 11.5628 15.529 11.7872 15.529 12.0189C15.529 12.2505 15.4486 12.4749 15.3015 12.6539L10.3015 18.6539C10.2012 18.7749 10.0737 18.8705 9.92953 18.9331C9.78532 18.9956 9.62839 19.0233 9.47149 19.0139Z" fill="#A63F3F"/>
                            </svg>
                            View
                            <div class="btnGroupContainer">
                                <a href="#" class="print">
                                    <svg viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M13.5 13.125V14.0625C13.5 14.5101 13.3222 14.9393 13.0057 15.2557C12.6893 15.5722 12.2601 15.75 11.8125 15.75H6.1875C5.73995 15.75 5.31072 15.5722 4.99426 15.2557C4.67779 14.9393 4.5 14.5101 4.5 14.0625V13.1243L3.1875 13.125C2.73995 13.125 2.31072 12.9472 1.99426 12.6307C1.67779 12.3143 1.5 11.8851 1.5 11.4375V6.9405C1.5 6.29403 1.75681 5.67405 2.21393 5.21693C2.67105 4.75981 3.29103 4.503 3.9375 4.503L4.49925 4.50225L4.5 3.9375C4.5 3.48995 4.67779 3.06072 4.99426 2.74426C5.31072 2.42779 5.73995 2.25 6.1875 2.25H11.814C12.2616 2.25 12.6908 2.42779 13.0072 2.74426C13.3237 3.06072 13.5015 3.48995 13.5015 3.9375V4.50225H14.064C14.7105 4.50265 15.3304 4.75953 15.7877 5.21652C16.2449 5.67352 16.5022 6.29327 16.503 6.93975L16.5052 11.4375C16.5053 11.659 16.4618 11.8784 16.3771 12.083C16.2925 12.2877 16.1683 12.4737 16.0117 12.6304C15.8552 12.7871 15.6693 12.9115 15.4647 12.9963C15.2601 13.0812 15.0408 13.1249 14.8192 13.125H13.5ZM11.8125 10.125H6.1875C6.03832 10.125 5.89524 10.1843 5.78975 10.2898C5.68426 10.3952 5.625 10.5383 5.625 10.6875V14.0625C5.625 14.373 5.877 14.625 6.1875 14.625H11.8125C11.9617 14.625 12.1048 14.5657 12.2102 14.4602C12.3157 14.3548 12.375 14.2117 12.375 14.0625V10.6875C12.375 10.5383 12.3157 10.3952 12.2102 10.2898C12.1048 10.1843 11.9617 10.125 11.8125 10.125ZM11.814 3.375H6.1875C6.03832 3.375 5.89524 3.43426 5.78975 3.53975C5.68426 3.64524 5.625 3.78832 5.625 3.9375L5.62425 4.50225H12.3765V3.9375C12.3765 3.78832 12.3172 3.64524 12.2117 3.53975C12.1063 3.43426 11.9632 3.375 11.814 3.375Z" fill="black" fill-opacity="0.87"/>
                                    </svg>
                                    Print
                                </a>
                                <button type="button" class="chartView" id="view-chart">
                                    <svg viewBox="0 0 21 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18.2109 16.7422H4.10156V3.94531C4.10156 3.85508 4.02773 3.78125 3.9375 3.78125H2.78906C2.69883 3.78125 2.625 3.85508 2.625 3.94531V18.0547C2.625 18.1449 2.69883 18.2188 2.78906 18.2188H18.2109C18.3012 18.2188 18.375 18.1449 18.375 18.0547V16.9062C18.375 16.816 18.3012 16.7422 18.2109 16.7422ZM5.90625 15.1016H7.05469C7.14492 15.1016 7.21875 15.0277 7.21875 14.9375V11.9844C7.21875 11.8941 7.14492 11.8203 7.05469 11.8203H5.90625C5.81602 11.8203 5.74219 11.8941 5.74219 11.9844V14.9375C5.74219 15.0277 5.81602 15.1016 5.90625 15.1016ZM9.02344 15.1016H10.1719C10.2621 15.1016 10.3359 15.0277 10.3359 14.9375V8.375C10.3359 8.28477 10.2621 8.21094 10.1719 8.21094H9.02344C8.9332 8.21094 8.85938 8.28477 8.85938 8.375V14.9375C8.85938 15.0277 8.9332 15.1016 9.02344 15.1016ZM12.1406 15.1016H13.2891C13.3793 15.1016 13.4531 15.0277 13.4531 14.9375V9.97461C13.4531 9.88437 13.3793 9.81055 13.2891 9.81055H12.1406C12.0504 9.81055 11.9766 9.88437 11.9766 9.97461V14.9375C11.9766 15.0277 12.0504 15.1016 12.1406 15.1016ZM15.2578 15.1016H16.4062C16.4965 15.1016 16.5703 15.0277 16.5703 14.9375V6.73438C16.5703 6.64414 16.4965 6.57031 16.4062 6.57031H15.2578C15.1676 6.57031 15.0938 6.64414 15.0938 6.73438V14.9375C15.0938 15.0277 15.1676 15.1016 15.2578 15.1016Z" fill="black"/>
                                    </svg>
                                    Chart View
                                </button>

                                <a href="<?php echo URLROOT;?>/survey_report/view_report/<?php echo $data['survey']->id?>" style="display:none" id="return-normal">
                                    <svg viewBox="0 0 21 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18.2109 16.7422H4.10156V3.94531C4.10156 3.85508 4.02773 3.78125 3.9375 3.78125H2.78906C2.69883 3.78125 2.625 3.85508 2.625 3.94531V18.0547C2.625 18.1449 2.69883 18.2188 2.78906 18.2188H18.2109C18.3012 18.2188 18.375 18.1449 18.375 18.0547V16.9062C18.375 16.816 18.3012 16.7422 18.2109 16.7422ZM5.90625 15.1016H7.05469C7.14492 15.1016 7.21875 15.0277 7.21875 14.9375V11.9844C7.21875 11.8941 7.14492 11.8203 7.05469 11.8203H5.90625C5.81602 11.8203 5.74219 11.8941 5.74219 11.9844V14.9375C5.74219 15.0277 5.81602 15.1016 5.90625 15.1016ZM9.02344 15.1016H10.1719C10.2621 15.1016 10.3359 15.0277 10.3359 14.9375V8.375C10.3359 8.28477 10.2621 8.21094 10.1719 8.21094H9.02344C8.9332 8.21094 8.85938 8.28477 8.85938 8.375V14.9375C8.85938 15.0277 8.9332 15.1016 9.02344 15.1016ZM12.1406 15.1016H13.2891C13.3793 15.1016 13.4531 15.0277 13.4531 14.9375V9.97461C13.4531 9.88437 13.3793 9.81055 13.2891 9.81055H12.1406C12.0504 9.81055 11.9766 9.88437 11.9766 9.97461V14.9375C11.9766 15.0277 12.0504 15.1016 12.1406 15.1016ZM15.2578 15.1016H16.4062C16.4965 15.1016 16.5703 15.0277 16.5703 14.9375V6.73438C16.5703 6.64414 16.4965 6.57031 16.4062 6.57031H15.2578C15.1676 6.57031 15.0938 6.64414 15.0938 6.73438V14.9375C15.0938 15.0277 15.1676 15.1016 15.2578 15.1016Z" fill="black"/>
                                    </svg>
                                    Return
                                </a>
                            </div>
                        </h2>
                        <!-- for each -->

                        <?php 
                        $i = 0;
                        foreach($data['questions'] as $row):
                        $i++; ?>
                        <div class="questionCon">
                            <div class="questionHeader">
                                <h3><?php echo $i?>. <?php echo $row->question?></h3>
                                <span class="questionType"><?php echo ($row->type == 'check' || $row->type == 'radio') ? 'Multiple Choice': 'Paragraph'?></span>
                            </div>
                            <!-- Multiple Choice -->
                            <!-- for each ageyn-->
                            <div class="answerCon">
                            <?php if($row->type != 'textfield_s'):?>
                                <ul class="answer-list">
                                <?php foreach(json_decode($row->frm_option) as $k => $v):
                                        $progress = ((isset($data['answers'][$row->id][$k]) ? count($data['answers'][$row->id][$k]) : 0) / $data['taken']) * 100;
                                        $progress = round($progress,2);
                                ?>
                                    <li class="answer">
                                        <div class="flex-con">
                                            <p><?php echo $v?></p>
                                            <span class="answer-ratio"><?php echo isset($data['answers'][$row->id][$k]) ? count($data['answers'][$row->id][$k]) : 0 ?>/<?php echo $data['taken']?></span>
                                            <div class="answer-progress-bar">
                                                <div class="answer-progress-bar-percent" style="width:<?php echo $progress?>%"></div>
                                            </div>
                                            <span class="answer-percentage"><?php echo $progress?>%</span>
                                        </div>
                                    </li>
                                <?php endforeach;?>
                                </ul>
                            <?php else:?>
                                <?php if(isset($data['answers'][$row->id])):?>
                                    <?php foreach($data['answers'][$row->id] as $val):?>
                                        <textarea name="q2a" id="answer-para" readonly><?php echo $val;?>
                                        </textarea>
                                    <?php endforeach;?>
                                <?php endif;?>
                            <?php endif;?>
                            </div>
                        </div>
                        
                        <?php endforeach;?>
                        
                        
                    </div>

                    <div class="form">
                        <a href="<?php echo URLROOT?>/admin/survey_report" class="closeIcon">
                            <svg viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.7624 15L22.1374 9.63749C22.3728 9.40211 22.505 9.08287 22.505 8.74999C22.505 8.41711 22.3728 8.09787 22.1374 7.86249C21.902 7.62711 21.5828 7.49487 21.2499 7.49487C20.917 7.49487 20.5978 7.62711 20.3624 7.86249L14.9999 13.2375L9.63742 7.86249C9.40204 7.62711 9.0828 7.49487 8.74992 7.49487C8.41705 7.49487 8.0978 7.62711 7.86242 7.86249C7.62704 8.09787 7.49481 8.41711 7.49481 8.74999C7.49481 9.08287 7.62704 9.40211 7.86242 9.63749L13.2374 15L7.86242 20.3625C7.74526 20.4787 7.65227 20.6169 7.58881 20.7693C7.52535 20.9216 7.49268 21.085 7.49268 21.25C7.49268 21.415 7.52535 21.5784 7.58881 21.7307C7.65227 21.883 7.74526 22.0213 7.86242 22.1375C7.97863 22.2547 8.11688 22.3476 8.2692 22.4111C8.42153 22.4746 8.58491 22.5072 8.74992 22.5072C8.91494 22.5072 9.07832 22.4746 9.23064 22.4111C9.38297 22.3476 9.52122 22.2547 9.63742 22.1375L14.9999 16.7625L20.3624 22.1375C20.4786 22.2547 20.6169 22.3476 20.7692 22.4111C20.9215 22.4746 21.0849 22.5072 21.2499 22.5072C21.4149 22.5072 21.5783 22.4746 21.7306 22.4111C21.883 22.3476 22.0212 22.2547 22.1374 22.1375C22.2546 22.0213 22.3476 21.883 22.411 21.7307C22.4745 21.5784 22.5072 21.415 22.5072 21.25C22.5072 21.085 22.4745 20.9216 22.411 20.7693C22.3476 20.6169 22.2546 20.4787 22.1374 20.3625L16.7624 15Z" fill="black" fill-opacity="0.87"/>
                            </svg>
                        </a>
                        <div class="surveyInfoCon">
                            <h4>Title:</h4>
                            <p class="surveyTitle"><?php echo $data['survey']->title ?></p>
                            <h4>Description:</h4>
                            <p class="surveyDescription"><?php echo $data['survey']->description?></p>
                        </div>
                        <div class="dateInfo">
                            <h4>Created on:</h4>
                            <p class="created-date"><?php echo $data['survey']->date_created?></p>
                            <h4>Total Respondents:</h4>
                            <p class="updated-date"><?php echo $data['taken']?></p>
                        </div>
                    </div>
                </form>
            </section>
        </main>
    </div>
</div>
    
    <script src="<?php echo URLROOT;?>/js/view_chart.js" >
      
    </script>


    <script>
        $('#print').click(function(){
            var new_window = window.open("<?php echo URLROOT;?>/survey_report/print_report/<?php echo $data['survey']->id?>", "", "width = 850, height =700")
           
        })        

    </script>